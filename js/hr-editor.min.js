const HREditor=(()=>{let t=null,e=null,n=null,a=null,o={toolbar:["heading","bold","italic","underline","undo","redo","indent","outdent","justifyLeft","justifyCenter","justifyRight","createLink","insertImage","insertVideo","unorderedList","orderedList"]},i=null,l={heading:`<select class="heading">
                    <option value="P">Paragraph</option>
                    <option value="H1">Heading 1</option>
                    <option value="H2">Heading 2</option>
                    <option value="H3">Heading 3</option>
                  </select>`,bold:'<button type="button" data-command="bold"><i class="fas fa-bold"></i></button>',italic:'<button type="button" data-command="italic"><i class="fas fa-italic"></i></button>',underline:'<button type="button" data-command="underline"><i class="fas fa-underline"></i></button>',undo:'<button type="button" data-command="undo"><i class="fas fa-undo"></i></button>',redo:'<button type="button" data-command="redo"><i class="fas fa-redo"></i></button>',indent:'<button type="button" data-command="indent"><i class="fas fa-indent"></i></button>',outdent:'<button type="button" data-command="outdent"><i class="fas fa-outdent"></i></button>',justifyLeft:'<button type="button" data-command="justifyLeft"><i class="fas fa-align-left"></i></button>',justifyCenter:'<button type="button" data-command="justifyCenter"><i class="fas fa-align-center"></i></button>',justifyRight:'<button type="button" data-command="justifyRight"><i class="fas fa-align-right"></i></button>',createLink:'<button type="button" data-command="createLink"><i class="fas fa-link"></i></button>',insertImage:`<div class="dropdown">
                         <button type="button" id="imageButton"><i class="fas fa-image"></i></button>
                         <div class="dropdown-content">
                             <div class="content-inner">
                                 <button type="button" id="imageUploadButton">Upload Image</button>
                                 <button type="button" id="imageUrlButton">Insert Image URL</button>
                                 <input type="file" id="imageUpload" style="display:none;" accept="image/*">
                             </div>
                         </div>
                      </div>`,insertVideo:`<div class="dropdown">
                         <button type="button" id="videoButton"><i class="fas fa-video"></i></button>
                         <div class="dropdown-content">
                             <div class="content-inner">
                                 <button type="button" id="videoUploadButton">Upload Video</button>
                                 <button type="button" id="videoUrlButton">Insert Video URL</button>
                                 <input type="file" id="videoUpload" style="display:none;" accept="video/*">
                             </div>
                         </div>
                      </div>`,unorderedList:'<button type="button" data-command="insertUnorderedList"><i class="fas fa-list-ul"></i></button>',orderedList:'<button type="button" data-command="insertOrderedList"><i class="fas fa-list-ol"></i></button>'},s={createLink:"Enter the link URL"};function d(){let e=window.getSelection();e.rangeCount&&(t=e.getRangeAt(0))}function r(){if(t){let e=window.getSelection();e.removeAllRanges(),e.addRange(t)}}function u(e){r(),t&&(t.deleteContents(),t.insertNode(e),d(),c())}function c(){e&&i&&e(i.innerHTML)}function f(t){let e=document.createElement("div");return e.className="hr-toolbar",(t.toolbar||o.toolbar).forEach(t=>{e.innerHTML+=l[t]||""}),e}function b(t,e){let n=t.getAttribute("data-command");if(s[n]){let a=prompt(s[n]);a&&document.execCommand(n,!1,a)}else document.execCommand(n,!1,null);e.focus(),c()}function p(l,s={}){s={...o,...s};let p=f(s);(i=document.createElement("div")).className="hr-editor",i.contentEditable=!0;let g=document.createElement("div");g.className="hr-image-toolbar",g.innerHTML=`
            <button type="button" id="floatLeft"><i class="fas fa-align-left"></i></button>
            <button type="button" id="floatRight"><i class="fas fa-align-right"></i></button>
            <button type="button" id="block"><i class="fas fa-align-justify"></i></button>
            <button type="button" id="resize"><i class="fas fa-expand"></i></button>
            <button type="button" id="margin-right"><i class="fa-solid fa-angles-right"></i></button>
            <button type="button" id="margin-left"><i class="fa-solid fa-angles-left"></i></button>
            <button type="button" id="margin-top"><i class="fa-solid fa-angles-up"></i></button>
            <button type="button" id="margin-bottom"><i class="fa-solid fa-angles-down"></i></button>
        `,document.body.appendChild(g),l.style.position="relative",l.appendChild(p),l.appendChild(i),n=s.imageHandler||null,a=s.videoHandler||null,p.querySelectorAll(".heading").forEach(t=>{t.addEventListener("change",t=>{document.execCommand("formatBlock",!1,t.target.value),i.focus(),c()})}),p.querySelectorAll("button[data-command]").forEach(t=>{t.addEventListener("click",()=>b(t,i))});let m=t=>{t.stopPropagation();let e=t.currentTarget.nextElementSibling;document.querySelectorAll(".dropdown-content").forEach(t=>t.classList.remove("show")),e.classList.toggle("show")};p.querySelectorAll("#imageButton, #videoButton").forEach(t=>{t.addEventListener("click",m)});let y=(t,e)=>{let n=t.target.files[0];if(e)e(n);else{let a=new FileReader;a.onload=e=>{let n=document.createElement(t.target.accept.startsWith("image")?"img":"video");n.src=e.target.result,n.className=`hr-editor-${t.target.accept.startsWith("image")?"image":"video"}`,"VIDEO"===n.tagName&&(n.controls=!0),u(n),i.focus()},a.readAsDataURL(n)}},h=t=>{let e=prompt(`Enter the ${t} URL`);if(e){let n=document.createElement(t);n.src=e,n.className=`hr-editor-${t}`,"VIDEO"===n.tagName&&(n.controls=!0),u(n),i.focus()}},v=p.querySelector("#imageUpload");p.querySelector("#imageUploadButton").addEventListener("click",()=>v.click()),v.addEventListener("change",t=>y(t,n)),p.querySelector("#imageUrlButton").addEventListener("click",()=>h("img"));let E=p.querySelector("#videoUpload");p.querySelector("#videoUploadButton").addEventListener("click",()=>E.click()),E.addEventListener("change",t=>y(t,a)),p.querySelector("#videoUrlButton").addEventListener("click",()=>h("video")),document.addEventListener("click",t=>{t.target.matches("#imageButton, #videoButton")||document.querySelectorAll(".dropdown-content").forEach(t=>t.classList.remove("show"))}),i.addEventListener("paste",t=>{let e=t.clipboardData||window.clipboardData,n=e.items;for(let a=0;a<n.length;a++)if(n[a].type.startsWith("image")||n[a].type.startsWith("video")){t.preventDefault();return}});let L=new MutationObserver(t=>{t.forEach(t=>{"childList"===t.type&&t.addedNodes.forEach(t=>{if(t.nodeType===Node.TEXT_NODE){let e=/((https?:\/\/)?[^\s]+\.[^\s]+)/g,n;for(;null!==(n=e.exec(t.textContent));){let a=n[0],o=document.createElement("a");o.href=a.startsWith("http")?a:`http://${a}`,o.textContent=a;let i=document.createRange();i.setStart(t,n.index),i.setEnd(t,n.index+a.length),i.deleteContents(),i.insertNode(o)}}})})});return L.observe(i,{childList:!0,subtree:!0}),i.addEventListener("keydown",t=>{"Tab"===t.key&&(t.preventDefault(),document.execCommand(t.shiftKey?"outdent":"indent"),c())}),i.addEventListener("keypress",t=>{"Enter"===t.key&&(t.preventDefault(),document.execCommand("insertParagraph"),c())}),i.addEventListener("input",()=>{d(),c()}),i.addEventListener("click",t=>{let e=t.target;if("IMG"===e.tagName||"VIDEO"===e.tagName){let n=e.getBoundingClientRect();g.style.display="block",g.style.top=`${n.top-g.offsetHeight}px`,g.style.left=`${n.left}px`,g.target=e}else g.style.display="none"}),g.querySelectorAll("button").forEach(t=>{t.addEventListener("click",t=>{let e=g.target,n=t.currentTarget.id;if(n.includes("float"))e.style.float=n.replace("float","").toLowerCase();else if("block"===n)e.style.display="block",e.style.float="none";else if("resize"===n){let a=prompt("Enter new width (px or %)",e.width||e.style.width);a&&(e.style.width=a)}else if(n.startsWith("margin")){let o=n.split("-")[1];!function t(e,n){let a=getComputedStyle(e),o=`margin${n.charAt(0).toUpperCase()+n.slice(1)}`,i=prompt(`Enter margin to ${n} (px or %)`,a[o]);i&&(e.style[o]=i,c())}(e,o)}g.style.display="none",c()})}),{onChange(t){e=t},insertImage(t){let e=document.createElement("img");e.src=t,e.className="editor-image",u(e),i.focus()},insertVideo(t){let e=document.createElement("video");e.src=t,e.controls=!0,e.className="editor-video",u(e),i.focus()},getCursorPosition:()=>t,setCursorPosition(e){t=e,r()},getContent:()=>i.innerHTML,setContent(t){i.innerHTML=t,c()}}}return{init:p}})();